# 9장 프론트엔드 프레임워크와 백엔드 프레임워크

타입스크립트는 Node.js 런타임뿐만 아니라 원래 자바스크립트의 고향인 프론트엔드 개발에서도 상당히 유용하다. 특히 프론트엔드와 백엔드를 모두 TypeScript로 구현한다면 종전과는 비교할 수 없을 정도로 높은 개발 안정성과 편의성을 확보할 수 있다. 프론트엔드-백엔드 상호 간 데이터 통신을 위해서는 일반적으로 JSON 형식의 REST API를 구현하게 되는데, 이렇게 사용되는 데이터 포맷은 개발 과정 중에 수없이 변경되고 또 변경되기 마련이다. 이로 인해 프론트엔드와 백엔드 개발자 사이에서는 수도 없이 커뮤니케이션 로스(Loss)가 발생하고 이는 고스란히 개발자의 피로도 상승 및 개발 기간 증가, 유지보수성의 저하로 이어진다. 게다가 이러한 문제점은 실제로 코드를 동작시키지 전까지는 알아채기 어려운 경우도 많기 때문에 최악의 경우 검증되지 않은 버그가 남은 채 프로젝트를 퍼블리시하게 될 수도 있다. TypeScript가 이러한 사태를 미연에 방지할 수 있는 이유는, 프론트엔드와 백엔드간의 데이터 포맷을 타입으로 정의하여, 이를 양측에서 공통으로 참조하도록 구현하고, 데이터 포맷의 변경 사항이 발생할 경우 이렇게 공용화된 타입의 정의부를 수정함에 따라 프론트엔드와 백엔드 코드에 컴파일 에러를 발생시킴으로써 데이터 포맷의 통일을 강제하기 때문이다.
물론 백엔드 개발자들은, 타입스크립트 사용 이전에 프론트엔드 개발자에게 올바른 API를 제공하고 Swagger등의 API문서의 작성이 선행되는 게 권장되기는 하겠으나, IDE에서 제공하는 자동 완성이나 API 에러 알림 등의 피드백 덕분에 문서 참조의 필요성을 줄일 수 있다는 것 자체가 상당한 장점이다.

<br>

## 다른 웹 프레임워크와의 비교

| 프레임워크 | 개발언어 | 설명 |
|----------|--------------|------------------------------------------|
| React | Javascript<br>Typescript | SPA(Single Page Application)나 모바일 앱 개발에 사용된다.<br> 최근 몇 년간 가장 인기있는 프론트엔드 프레임워크<br> 가상 DOM(Virtual Document Object Model)을 사용한다<br> 페이스북이 주도하는 공동체에서 유지 보수되고 있다.<br> |
| Vue.js | Javascript<br>Typescript | React.js와 함께 인기있는 프론트엔드 프레임워크<br> SPA를 구축할 수 있다<br> MVVM 패턴에서 VM(View Model)에 해당하는 라이브러리<br> 속도가 빠르다<br>  |
| Angular | Typescript | SPA를 위한 프레임워크면서 SSR을 지원한다<br> 모듈/컴포넌트 기반으로 작성하며 재사용성 높은 SW를 만들수 있다<br> 2021년 말 Angular 1.x인 AngularJS의 LTS 지원이 중단되었다.<br> |
| Svelte | Javascript<br>Typescript | React, Vue.js를 제치고 최근 인기순위 1위로 등극한 프론트엔드 프레임워크<br> 가상 DOM을 사용하지 않는다<br> 적은 코드로 구현이 가능하고 이로 인한 유지 보수성이 좋다<br> |
| Express | Javascript<br>Typescript | 가장 많은 사용자를 가지고 있는 Node.js 기반 백엔드 프레임워크<br> 가볍게 서버를 구동시킬 수 있다<br> NestJS와 같이 Express를 기반으로 하는 프레임워크도 존재한다<br> |
| Spring | Java<br>Kotlin | 국내에서 인기가 높은 자바기반 프레임워크.<br> 전자정부프레임워크를 이용하는 프로젝트를 수행하기 위해서는 스프링을 알아야 하기 때문에 그 영향이 크다<br> IoC, DI, AOP와 같은 객체 지향 프로그래밍 기법을 쉽게 적용할 수 있다<br> |
| STRUTS | Java | 자바기반의 JSP만을 위한 프레임워크<br> MVC 모델 기반의 웹 애플리케이션을 쉽게 작성할 수 있게 해 준다<br> 한 때 JSP가 많이 사용되었으나 처음 배우는 독자라면 추천하지 않는다<br> |
| Django | Python | 파이썬 기반 웹 프레임워크의 표준이라 할 수 있다<br> MVC 패턴을 사용한다<br> |
| Gin | Go | Golang 기반의 웹 프레임워크<br> |
| Ruby on Rails | Ruby | 간결한 문법<br> 뛰어난 생산성으로 인기를 얻었다<br> ActiveRecord를 이용하여 쿼리를 쉽게 다룰수 있게 해 준다<br> |


<br>

---------------------------------------------------------------------

<br>

## 1. 프론트엔드와 Type Script
물론 프론트엔드에서도 단독으로 사용이 가능하다. 바닐라 자바스크립트로 컴파일 되는 것은 당연하거니와, Google의 Angular프레임워크는 2.0부터 아예 타입스크립트만 사용가능하도록 바뀌었다. Facebook의 리액트는 React.js와 React Native를 가리지 않고 타입스크립트 사용이 가능하다. 현재는 JavaScript와 TypeScript진영간의 교류도 굉장히 활발하고, DefinitelyTyped 등의 기여로부터 React에서 TypeScript를 사용하는 것은 정석 중의 하나로 자리잡았다. React의 경우는 특히나 Function Component, Hooks와 함께 타입스크립트를 사용한다면 이전에 클래스 컴포넌트를 사용할때보다 훨씬 쉽게 개발이 가능하다.

<br>

### 리액트(React)
리액트와 타입스크립트의 호환성은 비교적 좋은 편입니다. 최근 들어 많은 개발자들이 리액트와 타입스크립트 조합을 선택하고 있습니다. 리액트 공식 홈페이지에서는 타입스크립트를 사용하기 위한 가이드를 제시하고 있습니다. 페이스북에서 공식적으로 배포하는 리액트 웹 개발용 보일러 플레이트(Boilerplate, 구조·설정 작업을 자동으로 진행해주는 도구이자 명령어)인 Create React App은 간단한 옵션 추가만으로 타입스크립트를 사용할 수 있도록 지원합니다.

<br>


### 뷰(Vue.js)
뷰 2.0에서는 타입스크립트를 사용할 수 있지만 몇몇 라이브러리의 도움을 받아야 하거나 구현 자체가 안 되는 문제도 다수 있었습니다. 다행스럽게도 최근 릴리즈된 뷰 3.0부터는 타입스크립트를 공식 지원합니다. 뷰 3.0 CLI(Command Line Interface)는 타입스크립트 도구화 지원을 기본으로 제공합니다.

<br>


### 앵귤러(Angular)
자바스크립트 기반인 앵귤러 버전 1과 달리 버전 2부터는 타입스크립트 기반으로 만들어졌고 타입스크립트를 권장하고 있습니다.

<br>

### 기존의 자바스크립트 소스와의 호환
타입스크립트를 사용할 때, 타입스크립트가 런타임에서 그대로 돌아가는 경우는 드물다. 개요에 서술하였듯 타입스크립트는 컴파일을 통해 자바스크립트로 변환되는 것이 일단 첫번째 목적인데, 그렇기 때문에 기존의 자바스크립트와 함께 사용하는 것이 가능하며, 자바스크립트 런타임은 그 컴파일된 자바스크립트를 기존의 자바스크립트 파일과 실행 가능하게 되는 것이다. 기존의 자바스크립트 프로그래머들은 타입스크립트를 도입할 때, 처음 고려해봐야 할 것이 '*.d.ts' 파일 작성이다. 클래스, 클래스, 또는 어떤 자바스크립트 객체이든지 타입스크립트로 정의 가능한데, 기존의 자바스크립트 소스를 일절 건드리지 않고 *.d.ts 파일 작성만으로 타입스크립트 도입에 큰 도움을 줄 수 있다. DefinitelyTyped 레포지토리에서 다운받는 @types/<패키지이름> 패키지가 그것이다. 이 레포지토리는 기존 자바스크립트 npm 패키지들이 기존 소스를 건드리지 않고 타입스크립트 진영에 자연스럽게 녹아들 수 있도록 도움을 주었다. Javascript 언어 차원에서 지원하는 API들의 입출력 타입들도 친절하게 정의돼 있기 때문에 이를 더 안정적으로 사용할 수 있게 되기도 한다.

또한, 타입스크립트는 const, let 같은 es2015 이상의 버전에서 사용되는 구문을 지원하는데, 이걸 컴파일을 시키게 되면 es3 버전으로 컴파일을 시켜줘서 IE 구버전에서도 작동할 수 있게 해준다! 즉, 상위 버전의 자바스크립트 구문을 사용하고도 IE 구버전을 지원할 수 있다.

<br>

### 다른 언어와의 문법 유사성
에 자바스크립트가 C, C++, 자바나 C#같은 언어들처럼 (), {}, ; 등을 사용하는 C-family언어이기 때문에 문법적으로 유사함을 내세우는 타입스크립트 역시 C-family인데, 그 정도가 특히 더 가까워져서, 예를 들면 Generic에 <> 기호를 쓴다. 타입스크립트가 자바, C#, C++와는 본질적으로 비슷하지도 않지만, 타입스크립트를 처음 입문하는 기존 개발자들은 '어! 저거 제네릭이네!' 라고 빠르게 이해할 수 있을 것이다. 거기에 interface, const 같은 지시문 역시 기존 언어 사용자들이 익숙하다고 느낄만한 사용방법을 갖고 있다.

<br>


### 타입스크립트로 어떻게 전환하면 좋을까?
자바스크립트 프로젝트를 타입스크립트로 어떻게 전환할 수 있을까요? 유효한 자바스크립트는 유효한 타입스크립트이며 타입스크립트는 모든 타입을 명시적으로 선언하지 않아도 최선을 다해 타입을 추론하려고 합니다. 이러한 사실은 자바스크립트를 타입스크립트로 점진적, 단계적으로 전환할 수 있음을 의미합니다.

#### 1. 비주얼 스튜디오 코드(VSCode)로 자바스크립트 페어링
비주얼 스튜디오 코드에는 편집기 또는 특정 작업 영역(프로젝트)에 대해 자바스크립트에서 타입스크립트 검사를 활성화 할 수 있는 설정이 포함되어 있습니다. .vscode/setting.json에 다음 코드를 추가할 수 있습니다.
```
{
 "Javascript.implicitProjectConfig.checkJs": true
}
```

이제 타입이 안전하지 않은 줄에는 에디터에서 해당 코드를 에러로 표시합니다. 이러한 에러 메시지는 에디터에만 표시되며 코드에는 영향을 주지 않습니다.
@ts-ignore - 해당 줄
@ts-nocheck - 전체
해당 코드를 추가하여 타입 체크를 선택적으로 비활성화 할 수도 있습니다.


#### 2. 자바스크립트용 타입스크립트 컴파일러 사용
타입스크립트 컴파일러를 설치하고 스크립트를 실행하거나 설정합니다. tsconfig.json 파일을 사용하여 컴파일러 설정을 세팅합니다.
```
{
 "compilerOptions": {
  "allowJs": true
  "checkJs": false
  "outDir": "./dist"
  "rootDir": "./src"
  "strict": false
 }
}
```

"allowJs": true //타입스크립트 컴파일러를 통해 실행할 자바스크립트 파일을 선택
"checkJs": false //자바스크립트 파일에 대한 타입 체크

타입스크립트 컴파일러를 실행하고 자바스크립트를 확인합니다.
"checkJs": true 타입 체크를 활성화하고 타입 체크를 진행합니다. (node.js 경우에는 @types/node를 설치합니다.)

#### 3. 자바스크립트 파일을 타입스크립트 파일로 변환
자바스크립트에서 타입이 안전한 파일인지 확인한 후 하나씩 타입스크립트 파일로 변환합니다. (.js → .ts) allowJS를 활성화 했으므로 한번에 모두 이동할 필요 없이 점진적으로 이동할 수 있습니다. 이미 자바스크립트 코드에 대한 타입 체크를 실행했으므로 업데이트가 너무 많지 않을 것입니다.

#### 4. 엄격한 타입 체크
타입 체크를 더 엄격하게 하는 몇 가지 옵션이 있습니다.
```
{
 "compilerOptions": {
 "noImplicitAny": true,
 "strictNullChecks": true,
 "strictFunctionTypes": true,
 "strictBindCallApply": true,
 "strictPropertyInitialization": true,
 "noImplicitThis": true,
 "alwaysStrict": true
}
```

<br>

-----------------------------------------------------------

<br>

## 2. 백엔드와 Type Script

자바스크립트 기반 프론트엔드 프레임워크에서 백엔드 기능을 지원하려면, 일반적으로 Next.js와 Type Script를 연동하여 활용한다. 특히, React는 CSR 방식으로 렌더링하여, 초기 HTML이 비어있기 때문에 SEO에 좋지 하는 점이 있는데 이런 상황들을 간편하게 관리하기 위해서 Next.js 프레임워크를 사용한다.
즉, 리액트를 기반으로 하여 SPA을 빠르고 간편하게 빌드 할 수 있는 React 프레임워크일 경우 첫 페이지는 백엔드 서버에서 렌더링하며 빈 HTML이 아닌 데이터가 채워진 HTML을 받는다. 그 다음 페이지부턴 CSR 방식을 적용하여 필요한 데이터 부분만 갱신해 서버의 부하를 줄이게 된다.

<br>

### Next.js 연동하기

* Next.js 설치
```
yarn create next-app --typescript
```

* 개발 서버 실행
```
cd 해당 프로젝트명
yarn dev
웹 브라우저의 URL : http://localhost:3000
```

<br>

### 프로젝트 구조와 기본 디렉토리
* public : 프로젝트에 사용되는 정적 파일들
pages : 이 폴더 안에 각 페이지를 만들면 자동으로 라우팅 처리
    + _app.jsx(tsx)
        1) 모든 페이지의 공통 페이지 역할
        2) 모든 페이지들을 초기화하여 페이지들의 공통된 레이아웃
        3) 페이지를 탐색할 때 상태 유지
        4) 추가 데이터를 페이지에 주입
        5) 글로벌 CSS 추가
    + _document.jsx(tsx)
    + _error.jsx(tsx)
    + 404.jsx(tsx)
    + API > [api이름]
        별도의 서버 생성없이 api 라우트를 통해 db를 생성하고, 수정할 수 있다.
* styles : 스타일 관련 파일들

<br>

### 렌더링 수행 방식
1. SSR을 기반으로 서버에 사전에 저장된 렌더트리(render tree)의 HTML을 로드
2. 사전 렌더링(Pre-render)이후에는 CSR 사용
페이지가 그려진 이후에 페이지 내부에서 동적인 데이터를 패치(axios, fetch, XHLHttpRequest)하는 과정은 CSR방식을 따름
3. 만약 페이지가 로드될 때 함께 데이터가 패칭되어야 하는 상황이라면 next.js의 데이터 패칭방식(① getInitialProps/ ② getStaticProps / ③ getStaticPath / ④ getServerSideProps)을 이용해 첫 렌더링 시에 HTML 파일 뿐만 아니라 데이터가 패칭될 수 있도록 처리해야 한다.

<br>

### Next.js와 TypeScript를 연동하여 사용하는 이유
1. 사전 렌더링 및 서버 사이드 렌더링
서버 사이드 렌더링 기능을 제공하여 클라이언트 사이드 렌더링 환경보다 빠른 렌더링을 불러올 수 있다.
2. Hot Code Reloading을 지원
Next 개발 환경에서는 코드 변경 사항이 저장되면 응용 프로그램을 자동으로 다시 로드한다.
3. 자동 코드 분할
자동 코드 분할 기능 덕분에 코드의 모든 가져오기 번들로 묶여 각 페이지와 함께 제공
결과적으로, 불필요한 코드가 페이지에 로드되지 않게 된다.
= 앱을 지연 로딩하게 도와주고 성능을 향상 시켜준다. 앱의 코드의 양을 줄이지 않고도 필요하지 않은 코드를 불러오지 않게 하여 초기화 로딩에 필요한 비용을 줄여준다.
4. 설정이 필요없음
기본적으로 웹팩과 바벨을 사용하고 있다. 즉, 서버 사이드 렌더링 및 개발에 필요한 설정이 되어 있으므로 빠르게 개발을 시작할 수 있다.
사용하고 싶은 플러그인이 있다면 손쉽게 추가하여 사용할 수 있도록 지원을 하고 있다.
5. 타입스크립트가 내장됨
6. 파일기반 내비게이션 기능
리액트에서는 라우트를 위해서 'react-router'라는 라이브러리를 사용하여 라우팅 설정을 해줘야 한다. 즉, 페이지의 경로에 대하여 직접 설정을 해야하지만 넥스트는 파일 시스템 기반 라우팅을 사용한다. 곧 폴더의 경로에 따라 페이지의 경로가 설정되어 구축이 빠르고 관리가 편리하다는 장점이 있다.
